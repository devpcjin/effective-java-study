## ìŠ¤íŠ¸ë¦¼ê³¼ ì»¬ë ‰ì…˜
>ìŠ¤íŠ¸ë¦¼ê³¼ ì»¬ë ‰ì…˜ì€ ëª¨ë‘ ì—°ì†ëœ ìš”ì†Œ í˜•ì‹ì˜ ê°’ì„ ì €ì¥í•˜ëŠ” ìë£Œêµ¬ì¡°ì˜ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì œê³µ
(ë‘˜ë‹¤ ì—°ì†ì ì¸ ìë£Œë¥´ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ ë§Œë“¤ì–´ì§)
>
ê°€ì¥ í° ì°¨ì´ëŠ” **`ì–¸ì œ` **ê³„ì‚°í•˜ëŠëƒ!
>
**ì»¬ë ‰ì…˜**ì€ ëª¨ë“  ê°’ì„ `ë©”ëª¨ë¦¬`ì— ì €ì¥í•˜ëŠ” êµ¬ì¡°
ì–´ë–¤ ê³„ì‚°ì´ë“  ëª¨ë“  ìš”ì†Œë“¤ì´ ì»¬ë ‰ì…˜ì— ì¶”ê°€ë˜ê¸° ì „ì— ë¯¸ë¦¬ ê³„ì‚° (ì™¸ë¶€ë°˜ë³µ)
>
**ìŠ¤íŠ¸ë¦¼**ì€ ìš”ì²­í•  ë•Œë§Œ ìš”ì†Œë¥¼ ê³„ì‚° (ìŠ¤íŠ¸ë¦¼ì— ìš”ì†Œë¥¼ ì¶”ê°€í•˜ê±°ë‚˜ ì œê±°í•˜ëŠ” ê±´ ë¶ˆê°€ëŠ¥)

## Stream
- ìë£Œì˜ ëŒ€ìƒê³¼ ê´€ê³„ì—†ì´ ë™ì¼í•œ ì—°ì‚°ì„ ìˆ˜í–‰í•œë‹¤. (ì¼ê´€ì„±)
- ë°°ì—´, ì»¬ë ‰ì…˜ì„ ëŒ€ìƒìœ¼ë¡œ ì—°ì‚°ì„ ìˆ˜í–‰
- ì¼ê´€ì„± ìˆëŠ” ì—°ì‚°ìœ¼ë¡œ ìë£Œì˜ ì²˜ë¦¬ë¥¼ ì‰½ê³  ê°„ë‹¨í•˜ê²Œ í•¨
"ìë£Œ ì²˜ë¦¬ë¥¼ ì¶”ìƒí™”í–ˆë‹¤."ë¼ê³  í‘œí˜„í•¨
--------
- í•œë²ˆ ìƒì„±í•˜ê³  ì‚¬ìš©í•œ ìŠ¤íŠ¸ë¦¼ì€ ì¬ì‚¬ìš©ì´ ë¶ˆê°€ëŠ¥í•˜ë‹¤.
- ìë£Œì— ëŒ€í•´ ìŠ¤íŠ¸ë¦¼ì„ ìƒì„±í•˜ì—¬ ì—°ì‚°ì„ ìˆ˜í–‰í•˜ë©´ ìŠ¤íŠ¸ë¦¼ì€ ì†Œëª¨ëœë‹¤.
- ë‹¤ë¥¸ ì—°ì‚°ì„ ìˆ˜í–‰í•˜ê¸° ìœ„í•´ì„œëŠ” ìŠ¤íŠ¸ë¦¼ì„ ë‹¤ì‹œ ìƒì„±í•´ì•¼í•œë‹¤. 
----------
- ìŠ¤íŠ¸ë¦¼ì˜ ì—°ì‚°ì€ ê¸°ì¡´ì˜ ìë£Œë¥¼ ë³€ê²½í•˜ì§€ ì•ŠëŠ”ë‹¤.
- ìë£Œì— ëŒ€í•œ ìŠ¤íŠ¸ë¦¼ì„ ìƒì„±í•˜ë©´, ìŠ¤íŠ¸ë¦¼ì´ ì‚¬ìš©í•˜ëŠ” ë©”ëª¨ë¦¬ ê³µê°„ì€ ë³„ë„ë¡œ ìƒì„±ë˜ë¯€ë¡œ ì—°ì‚°ì´ ìˆ˜í–‰ë˜ë„ ê¸°ì¡´ ìë£Œì— ëŒ€í•œ ë³€ê²½ì€ ë°œìƒí•˜ì§€ ì•ŠëŠ”ë‹¤. 
---------
- ìŠ¤íŠ¸ë¦¼ì€ ì¤‘ê°„ ì—°ì‚°ê³¼ ìµœì¢… ì—°ì‚°ìœ¼ë¡œ êµ¬ë¶„ëœë‹¤.
- ìŠ¤íŠ¸ë¦¼ì— ëŒ€í•´ ì¤‘ê°„ ì—°ì‚°ì€ ì—¬ëŸ¬ ê°œì˜ ì—°ì‚°ì´ ì ìš©ë  ìˆ˜ ìˆì§€ë§Œ, ìµœì¢… ì—°ì‚°ì€ ë§ˆì§€ë§‰ì— í•œë²ˆë§Œ ì ìš©ëœë‹¤. 
- ìµœì¢… ì—°ì‚°ì´ í˜¸ì¶œë˜ì–´ì•¼ ì¤‘ê°„ ì—°ì‚°ì— ëŒ€í•œ ìˆ˜í–‰ì´ ì´ë£¨ì–´ì§€ê³  ê·¸ ê²°ê³¼ê°€ ë§Œë“¤ì–´ì§„ë‹¤.
ë•Œë¬¸ì— ì¤‘ê°„ ì—°ì‚°ì— ëŒ€í•œ ê²°ê³¼ë¥¼ ì—°ì‚° ì¤‘ì— ì•Œ ìˆ˜ ì—†ëŠ”ë° ì´ë¥¼ 'ì§€ì—° ì—°ì‚°(lazy)'ì´ë¼ê³  í•œë‹¤.
----------
## Stream ì‚¬ìš© ì˜ˆì œ
```java
import java.util.Arrays;
import java.util.stream.IntStream;

public class IntArrayStreamTest {
    public static void main(String[] args) {
        int[] arr = {1, 2, 3, 4, 5};
        for(int num : arr){
            System.out.println(num);
        }
        System.out.println();

        //ìŠ¤íŠ¸ë¦¼ì„ ìƒì„±í•˜ëŠ” ê²½ìš°
        Arrays.stream(arr).forEach(n -> System.out.println(n));

        IntStream is = Arrays.stream(arr);
        is.forEach(n-> System.out.println(n));
    }
}

```
- ë°°ì—´ì„ ë§Œë“¤ë©´ `Arrays(java.util.Arrays)` í´ë˜ìŠ¤ë¥¼ í™œìš©í•  ìˆ˜ ìˆìŒ
Arrays ë‚´ë¶€ì˜ streamë©”ì†Œë“œë¥¼ ì‚¬ìš©
`Arrays.stream(arr)`
: Integerë°°ì—´ì— ìˆëŠ” ìë£Œë¥¼ ê°–ê³  stream operationì„ í•  ìˆ˜ ìˆëŠ” Intstream ê°ì²´ë¥¼ return

- `forEach(intConsumer arg0)` 
: ìµœì¢… ì—°ì‚° ìŠ¤íŠ¸ë¦¼ / ìš”ì†Œë“¤ì„ í•˜ë‚˜ì”© êº¼ë‚´ëŠ” ë©”ì†Œë“œ
intConsumer > parmeterë¥¼ **ì†Œëª¨**í•˜ë©´ì„œ í•´ì•¼í•  ì•¡ì…˜ì„ êµ¬í˜„ = ëŒë‹¤ì‹ êµ¬í˜„

---------
## ì¤‘ê°„ ì—°ì‚°ê³¼ ìµœì¢… ì—°ì‚°
```java
import java.util.ArrayList;
import java.util.List;
import java.util.stream.Stream;

public class ArrayListStreamTest {
    public static void main(String[] args) {
        List<String> sList = new ArrayList<String>();
        sList.add("Dalgu");
        sList.add("Bingo");
        sList.add("Bukang");

        System.out.println(sList);

        // Collectionì˜ ë©”ì†Œë“œ stream()
        Stream<String> stream = sList.stream();
        stream.forEach(s-> System.out.println(s));

        //ì¤‘ê°„ ìŠ¤íŠ¸ë¦¼ (.sorted())
        sList.stream().sorted().forEach(s-> System.out.println(s));

        //ê°ì²´ ìì²´ì— ëŒ€í•œ operationì„ ì‚¬ìš©í•  ë•ŒëŠ” map()ì„ ì´ìš©
        // (ex. ê°ì²´ ìì²´ê°€ ê°€ì§„ get,setë©”ì†Œë“œ ë“±ì„ ì´ìš©í•  ë•Œ)
        sList.stream().map(s->s.length()).forEach(n-> System.out.println(n));

        //filter()
        sList.stream().filter(s->s.length() >= 6).forEach(n -> System.out.println(n));
    }
}
```
- ì¤‘ê°„ ì—°ì‚°ì˜ ì˜ˆ `filter()`,`map()`,`sorted()` ë“±
ì¡°ê±´ì— ë§ëŠ” ìš”ì†Œë¥¼ ì¶”ì¶œ(filter)í•˜ê±°ë‚˜ ìš”ì†Œë¥¼ ë³€í™˜ í•¨(map)
- ìµœì¢… ì—°ì‚°ì´ í˜¸ì¶œ ë  ë•Œ, ì¤‘ê°„ ì—°ì‚°ì´ ìˆ˜í–‰ë˜ê³  ê²°ê³¼ê°€ ìƒì„± ë¨ 

------------

## Streamì˜ íŠ¹ì§•
### ëŒë‹¤ì‹ìœ¼ë¡œ ìš”ì†Œ ì²˜ë¦¬ ì½”ë“œë¥¼ ì œê³µ
```java
import java.util.Arrays;
import java.util.List;
import java.util.stream.Stream;

public class LambdaExpressionExample {
    public static void main(String[] args) {
        List<Student> list = Arrays.asList(
                new Student("ë‹¬êµ¬", 90),
                new Student("ë¹™ê³ ", 92)
        );

        //ìŠ¤íŠ¸ë¦¼ìƒì„±
        Stream<Student> stream = list.stream();
        
        //List ì»¬ë ‰ì…˜ì—ì„œ Studentë¥¼ ë§¤ê°œê°’ìœ¼ë¡œ ê°€ì ¸ì™€ ëŒë‹¤ì‹ì˜ ë§¤ê°œê°’ìœ¼ë¡œ ì œê³µ
        stream.forEach(s -> {
            String name = s.getName();
            int score = s.getScore();
            System.out.println(name + " : " + score);
        });
    }
}

```
### ë‚´ë¶€ ë°˜ë³µìë¥¼ ì‚¬ìš©, ë³‘ë ¬ ì²˜ë¦¬ê°€ ìš©ì´
> #### ì™¸ë¶€ë°˜ë³µì(external iterator) 
ê°œë°œìê°€ ì½”ë“œë¡œ ì§ì ‘ ì»¬ë ‰ì…˜ì˜ ìš”ì†Œë¥¼ ë°˜ë³µí•´ì„œ ê°€ì ¸ì˜¤ëŠ” ì½”ë“œ íŒ¨í„´.
indexë¥¼ ì´ìš©í•˜ëŠ” forë¬¸, Iteratorë¥¼ ì´ìš©í•˜ëŠ” whileë¬¸ ë“±ì€ëª¨ë‘ ì™¸ë¶€ ë°˜ë³µìë¥¼ ì´ìš©í•œë‹¤. 
>
>#### ë‚´ë¶€ë°˜ë³µì(internal iterator)
ì»¬ë ‰ì…˜ ë‚´ë¶€ì—ì„œ ìš”ì†Œë“¤ì„ ë°˜ë³µì‹œí‚¤ê³ , ê°œë°œìëŠ” ìš”ì†Œë‹¹ ì²˜ë¦¬í•´ì•¼í•  ì½”ë“œë§Œ ì œê³µí•˜ëŠ” ì½”ë“œ íŒ¨í„´
![](https://velog.velcdn.com/images/nnakki/post/facefbbc-c1d5-4cf5-bcd8-46004ba88b65/image.png)

ğŸ‘‰ë‚´ë¶€ ë°˜ë³µìëŠ” ìš”ì†Œë“¤ì˜ ë°˜ë³µ ìˆœì„œë¥¼ ë³€ê²½í•˜ê±°ë‚˜, ë©€í‹° ì½”ì–´ CPUë¥¼ ìµœëŒ€í•œ í™œìš©í•˜ê¸° ìœ„í•´ ìš”ì†Œë“¤ì„ ë¶„ë°°ì‹œì¼œ ë³‘ë ¬ ì‘ì—…ì„ í•  ìˆ˜ ìˆê²Œ ë„ì™€ì£¼ê¸° ë•Œë¬¸ì— í•˜ë‚˜ì”© ì²˜ë¦¬í•˜ëŠ” ìˆœì°¨ì  ì™¸ë¶€ ë°˜ë³µìë³´ë‹¤ëŠ” íš¨ìœ¨ì ìœ¼ë¡œ ìš”ì†Œë¥¼ ë°˜ë³µì‹œí‚¬ ìˆ˜ ìˆìŒ!

![](https://velog.velcdn.com/images/nnakki/post/78bd1f78-40b0-40bb-a90f-f7cc62e8980b/image.png)

ğŸ‘‰ë³‘ë ¬ ì²˜ë¦¬ ì—­ì‹œ ì»¬ë ‰ì…˜ ë‚´ë¶€ì—ì„œ ì²˜ë¦¬ë˜ë¯€ë¡œ good
cf.ë³‘ë ¬ì²˜ë¦¬ : í•œ ê°€ì§€ ì‘ì—…ì„ ì„œë¸Œ ì‘ì—…ìœ¼ë¡œ ë‚˜ëˆ„ê³ , ì„œë¸Œ ì‘ì—…ë“¤ì„ ë¶„ë¦¬ëœ ìŠ¤ë ˆë“œì—ì„œ ë³‘ë ¬ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” ê²ƒ. ëŸ°íƒ€ì„ ì‹œì— í•˜ë‚˜ì˜ ì‘ì—…ì„ ì„œë¸Œ ì‘ì—…ìœ¼ë¡œ ìë™ìœ¼ë¡œ ë‚˜ëˆ„ê³ , ì„œë¸Œ ì‘ì—…ì˜ ê²°ê³¼ë¥¼ ìë™ìœ¼ë¡œ ê²°í•©í•´ì„œ ìµœì¢… ê²°ê³¼ë¬¼ì„ ìƒì„±.
>
**>ğŸš¨ë‹¤ë§Œ, Parallel()ì€ ê³µìœ ëœ thread poolì„ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— ì‹¬ê°í•œ ì„±ëŠ¥ ì¥ì• ë¥¼ ì¼ìœ¼í‚¬ ìˆ˜ ìˆë‹¤.
**

```java
import java.util.Arrays;
import java.util.List;
import java.util.stream.Stream;

public class ParallelExample {
    public static void main(String[] args) {
        List<String> list = Arrays.asList("ì¡°ì„±ì£¼", "ì´ë³‘ë ¬", "ê¹€ë„ìš±", "ê¹€ìœ ì§„", "ì¡°ì„±í˜¸");

        //ìˆœì°¨ì²˜ë¦¬
        Stream<String> stream = list.stream();
        //stream.forEach(s->ParallelExample.print(s))ì™€ ë™ì¼
        stream.forEach(ParallelExample::print);
        System.out.println();

        //ë³‘ë ¬ì²˜ë¦¬
        Stream<String> parallelStream = list.parallelStream();
        parallelStream.forEach(ParallelExample::print);
    }

    public static void print(String str){
        System.out.println(str + " : " + Thread.currentThread().getName());
    }
}

```
- ê²°ê³¼ (ë³‘ë ¬ì²˜ë¦¬ëŠ” main,ForkJoinPool(ìŠ¤ë ˆë“œí’€) 2ê°€ì§€ ìŠ¤ë ˆë“œì—ì„œ ì‘ì—…ì„ í•œ ê±¸ í™•ì¸ ê°€ëŠ¥)
![](https://velog.velcdn.com/images/nnakki/post/1b539569-b0d9-44e4-bbd0-421488d026d2/image.png) 

### ì¤‘ê°„ ì²˜ë¦¬ì™€ ìµœì¢… ì²˜ë¦¬ê°€ ê°€ëŠ¥
```java
import java.util.Arrays;
import java.util.List;

public class MapAndReduceExample {
    public static void main(String[] args) {
        List<Student> studentList = Arrays.asList(
                new Student("ë‹¬êµ¬", 10),
                new Student("ë¹™ê³ ", 15),
                new Student("ë¶€ê°•", 20)
        );

        double avg = studentList.stream()
                .mapToInt(Student::getScore)        //ì¤‘ê°„ì²˜ë¦¬(í•™ìƒ ê°ì²´ë¥¼ ì ìˆ˜ë¡œ ë§¤í•‘)
                .average()                          //ìµœì¢…ì²˜ë¦¬(í‰ê· ì ìˆ˜)
                .getAsDouble();

        System.out.println(avg);
    }
}
```
- ëŒ€ëŸ‰ì˜ ë°ì´í„°ë¥¼ ê°€ê³µí•´ì„œ ì¶•ì†Œí•˜ëŠ” ê²ƒì„ Reduction(ë¦¬ë•ì…˜)ì´ë¼ê³  í•¨.
- í•©ê³„, í‰ê· ê°’, ì¹´ìš´íŒ…, ìµœëŒ€,ìµœì†Œê°’ ë“±ì´ ëª¨ë‘ ëŒ€í‘œì  ë¦¬ë•ì…˜ì˜ ê²°ê³¼ë¬¼ 
ê²°ê³¼ë¬¼ì„ ë°”ë¡œ ì§‘ê³„í•  ìˆ˜ ì—†ì„ ê²½ìš°, ì§‘ê³„í•˜ê¸° ì¢‹ë„ë¡ streamì˜ ì¤‘ê°„ì²˜ë¦¬ê°€ í•„ìš”í•œ ê²ƒ
ex) ë‚¨ì í‰ê·  ë‚˜ì´
```java
double avg = list.stream()
	.filter(m -> m.getSex()==Member.MALE)		// ë‚¨ìë§Œ í•„í„°ë§
    .mapToInt(Member::getAge)					// ê°ì²´ë¥¼ ë‚˜ì´ë¡œ ë§¤í•‘ 
    .average()									// í‰ê·  ë‚˜ì´ ì§‘ê³„
    .getAsDouble();
```
-----------

## (+)Java8 Parallele Stream, ì„±ëŠ¥ì¥ì• 

- ì¼ë°˜ ë³‘ë ¬ì²˜ë¦¬ ì˜ˆì œ
```java
ExecutorService executor = Executors.newFixedThreadPool(5);
for (int i = 0; i < dealmaxList.size(); i++) {
	final int index = i;
    executor.submit(() -> {
		Thread.sleep(5000);
		System.out.println(Thread.currentThread().getName() 
			+ ", index=" + index + ", ended at " + new Date()); 	 
    });
}       
executor.shutdown();
```

- Java Parallel Stream ë³‘ë ¬ì²˜ë¦¬ ì˜ˆì œ
```java
dealmaxList.parallelStream().forEach(index -> {
	System.out.println("Starting " + Thread.currentThread().getName() 
		+ ", index=" + index + ", " + new Date());
	try {
		Thread.sleep(5000);
	} catch (InterruptedException e) { }
});

```

